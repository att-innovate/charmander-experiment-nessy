./bin/reset_cluster

sleep 10

echo "Start Vector"
./bin/start_vector
echo "Start analytics"
./bin/start_analytics
echo "Start DNS server"
./experiments/nessy/bin/start_dns-sl2

sleep 10
 
echo " "
echo "Now you can open Vector and InfluxDB."
read -p " When everything is ready, press any key to start simulation......."


for ((; ;))
do
	date
	./experiments/nessy/bin/start_normalload-u30
	

	sleep 2700  # 45min  0:45
	date
	./experiments/nessy/bin/start_normalload-u100
	

	sleep 900   # 15min	 1:00
	if [ $(($RANDOM%2)) -eq 0 ]; then 
		date
		./experiments/nessy/bin/start_bonesi-500
	fi

	sleep 600	#10min	1:10
	date
	./bin/kill_task bonesi
	./experiments/nessy/bin/start_normalload-u30


	sleep 1200 	#20min	1:30
	date
	./experiments/nessy/bin/start_normalload-u30


	sleep 1800 	#30min	2:00
	date
	./experiments/nessy/bin/start_normalload-peaktime

	
	sleep 900   # 15min	 2:15
	date
	./experiments/nessy/bin/start_normalload-u30


	sleep 900   # 15min  2:30
	date
	./experiments/nessy/bin/start_normalload-u30

	sleep 900   # 15min  2:45
	date
	./experiments/nessy/bin/start_normalload-u30

	sleep 1800 	#30min	3:15
	if [ $(($RANDOM%2)) -eq 0 ]; then 
		date
		./experiments/nessy/bin/start_bonesi-500
	fi

	sleep 900   # 15min 3:30
	date
	./bin/kill_task bonesi
	./experiments/nessy/bin/start_normalload-u100

	sleep 900   # 15min 3:45
	date
	./experiments/nessy/bin/start_normalload-u100


	sleep 600	#10min	3:55
	date
	./experiments/nessy/bin/start_normalload-u30


	sleep 1200	#20min  4:15
	date
	./experiments/nessy/bin/start_normalload-peaktime

	sleep 900   #15min	4:30
	date
	./experiments/nessy/bin/start_normalload-peaktime
	./experiments/nessy/bin/start_normalload-u30

	sleep 900   #15min	4:45
	date
	./experiments/nessy/bin/start_normalload-u100
	./experiments/nessy/bin/start_normalload-u100

	sleep 1800	#30min	5:15
	date
	./experiments/nessy/bin/start_normalload-u30
	./experiments/nessy/bin/start_normalload-peaktime

	sleep 1800	#30min 5:45
	if [ $(($RANDOM%2)) -eq 0 ]; then 
		date
		./experiments/nessy/bin/start_bonesi-500
	fi

	sleep 600	#10min	5:55
	date
	./bin/kill_task bonesi


	sleep 300	#5min	6:00
	date
	./experiments/nessy/bin/start_normalload-u30
	./experiments/nessy/bin/start_normalload-u100

	sleep 2700	#45min	6:45
	date
	./experiments/nessy/bin/start_normalload-peaktime

	sleep 1800	#30min	7:15
	date
	./experiments/nessy/bin/start_normalload-u100

	sleep 2700	#45min	8:00
	date
	echo "A cycle completes!"


done	
 
